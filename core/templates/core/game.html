{% extends 'core/base.html' %}

{% block title %}Top Song Snippet{% endblock %}

{% block content %}
    <h1>Top Song: {{ track_name }} by {{ track_artists }}</h1>

    {% if preview_url %}
        <!-- Button to play the 2-second snippet -->
        <button id="play-snippet">Play 2-second snippet</button>

        <!-- Audio element (hidden until triggered) -->
        <audio id="audio-player" controls style="display:none;">
            <source src="{{ preview_url }}" type="audio/mp3">
            Your browser does not support the audio element.
        </audio>
    {% else %}
        <p>No preview available for your top track.</p>
    {% endif %}

    <script>
        // JavaScript to handle the 2-second playback
        document.getElementById('play-snippet').addEventListener('click', function() {
            var audio = document.getElementById('audio-player');
            audio.style.display = 'block';  // Make the audio player visible
            audio.play();  // Start playing the audio

            // Stop the audio after 2 seconds
            setTimeout(function() {
                audio.pause();  // Pause the audio
                audio.currentTime = 0;  // Reset to the beginning
            }, 2000);  // 2 seconds
        });
    </script>
{% endblock %}
