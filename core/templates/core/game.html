
{% extends 'core/base.html' %}

{% block title %}Guess the Song from Its Blurred Album Cover!{% endblock %}
{% block content %}
<h1 data-translatable="true">Guess the Song!</h1>
<form method="post" id="guess-form">
    {% csrf_token %}
    <ul>
        {% for track in top_tracks %}
            <li>
                <img src="{{ track.top_song_image }}" alt="Album cover for {{ track.name }}" class="album-cover" style="width: 100px; height: 100px; object-fit: cover;">
                <input type="text" name="guess_{{ track.id }}" placeholder="Guess the song..." class="guess-input" data-translatable="placeholder" />
                <input type="hidden" name="track_id_{{ track.id }}" value="{{ track.id }}">
            </li>
        {% empty %}
            <li data-translatable="true">No top tracks available</li>
        {% endfor %}
    </ul>

    <button type="submit" id="submit-guess" data-translatable="true">Submit Guess</button>
</form>
    <form method="get" action="{% url 'game' %}">
    <input type="hidden" name="reload" value="true">
    <button type="submit" id="reload-button">Reload Images</button>
</form>

{% if correct_guesses is not none %}

    <div class="score-box">
        <p>You guessed <strong>{{ correct_guesses }}</strong> tracks correctly!</p>
    </div>
{% endif %}

{% if new_score is not none %}
    <div class="score-box">
        <p>Your cumulative score is <strong>{{ new_score }}</strong>!</p>
    </div>
{% endif %}

<!-- Leaderboard -->
<h2>Leaderboard</h2>
<div class="leaderboard">
    {% for user in top_three_users %}
        <div class="leaderboard-item">
            <span class="rank">{{ user.rank }}.</span>
            <span class="username">{{ user.email }}:</span>
            <span class="score">{{ user.score }} Points</span>
        </div>
    {% empty %}
        <p>No leaderboard data available.</p>
    {% endfor %}
</div>





{% endblock %}